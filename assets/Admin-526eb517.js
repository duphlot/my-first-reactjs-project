var X=Object.defineProperty;var Z=(t,r,e)=>r in t?X(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var E=(t,r,e)=>(Z(t,typeof r!="symbol"?r+"":r,e),e);import{r as f,a as o,F as U,j as v,R as F,u as G,e as _,f as I}from"./index-6f94a2c2.js";import{a as B,r as q,b as Y,u as tt,g as et,o as rt}from"./index.esm2017-a3ba1131.js";import{a as k}from"./firebaseConfig-2d86aced.js";function at(){let[t,r]=f.useState([]),[e,i]=f.useState("");f.useState("");let[a,n]=f.useState("orderCode");const c=async()=>{const s=B(k),m=q(s,"order"),u=await Y(m);if(u.exists()){const h=u.val(),b=Object.keys(h).map(S=>({...h[S],fireBaseID:S}));r(b),console.log(u.val())}else alert("No data available")},g=()=>{const s=t.filter(m=>Object.values(m).some(u=>typeof u=="string"&&u.toLowerCase().includes(e.toLowerCase())));s.length>0?r(s):alert("Order not found")},d=s=>s.sort((m,u)=>(m[a]??"")<(u[a]??"")?-1:(m[a]??"")>(u[a]??"")?1:0),l=async(s,m)=>{const u=B(k),h=q(u,`order/${s}`);await tt(h,{status:m})};return f.useEffect(()=>{c()},[]),o(U,{children:o("body",{style:{overflowY:"scroll"},children:v("div",{className:"admin-container",children:[o("h1",{className:"admin-title",children:"Show the all order billing"}),v("div",{className:"admin-controls",children:[o("button",{className:"admin-button",onClick:c,children:"Reload"}),v("div",{className:"search-container",children:[v("div",{className:"sort-container",children:[o("label",{htmlFor:"sort",children:"Sort by: "}),v("select",{id:"sort",className:"sort-select",value:a,onChange:s=>n(s.target.value),children:[o("option",{value:"orderCode",children:"Order Code"}),o("option",{value:"igname",children:"IG Name"}),o("option",{value:"number",children:"Number"}),o("option",{value:"address",children:"Address"}),o("option",{value:"price",children:"Price"}),o("option",{value:"status",children:"Status"}),o("option",{value:"createdAt",children:"Date"})]})]}),o("input",{type:"text",className:"search-input",placeholder:"Search by any field",value:e,onChange:s=>i(s.target.value)}),o("button",{className:"search-button",onClick:g,children:"Search"})]})]}),v("table",{className:"order-table",children:[o("thead",{children:v("tr",{children:[o("th",{children:"Order Code"}),o("th",{children:"tên ig"}),o("th",{children:"Number"}),o("th",{children:"Address"}),o("th",{children:"Item"}),o("th",{children:"giá"}),o("th",{children:"sl"}),o("th",{children:"Total Price"}),o("th",{children:"Status"}),o("th",{children:"Date"})]})}),o("tbody",{children:d(t).map((s,m)=>v("tr",{className:"order-row",children:[o("td",{className:"order-code",children:s.orderCode}),o("td",{className:"order-igname",children:s.igname}),o("td",{className:"order-number",children:s.number}),o("td",{className:"order-address",children:s.address}),o("td",{className:"order-products",children:s.products&&Array.isArray(s.products)?s.products.map((u,h)=>o("div",{className:"product-details",children:o("span",{className:"product-name",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:u.name})},h)):o("span",{children:"No products available"})}),o("td",{className:"order-products",children:s.products&&Array.isArray(s.products)?s.products.map((u,h)=>o("div",{className:"product-details",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(Number(u.price.replace(/,/g,"").replace("VND","")))},h)):o("span",{children:"No products available"})}),o("td",{className:"order-products",children:s.products&&Array.isArray(s.products)?s.products.map((u,h)=>o("div",{className:"product-details",children:o("span",{className:"product-quantity",children:u.quantity})},h)):o("span",{children:"No products available"})}),o("td",{className:"order-price",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(Number(s.price))}),o("td",{className:"order-status",children:v("select",{value:s.status,onChange:async u=>{const h=[...t];h[m].status=u.target.value,r(h),await l(s.fireBaseID,u.target.value)},children:[o("option",{value:"chưa xác nhận",children:"Chưa xác nhận"}),o("option",{value:"đã xác nhận",children:"Đã xác nhận"}),o("option",{value:"đã hoàn thành",children:"Đã hoàn thành"})]})}),o("td",{className:"order-date",children:new Date(s.date??"").toLocaleString("vi-VN",{dateStyle:"short",timeStyle:"short"})})]},m))})]})]})})})}function ot(t){const[r,e]=f.useState(!0),[i,a]=f.useState(null),[n,c]=f.useState(!1),g=()=>{e(!1),c(!0)};return f.useEffect(()=>{if(!document){const m=new Error(`[ScriptLoadingError] document not defined when attempting to load ${t}`);a(m);return}const d=document.querySelector(`script[src="${t}"]`);if(d!=null&&d.dataset.loaded){g();return}const l=d||document.createElement("script");d||(l.src=t);const s=()=>{l.dataset.loaded="1",g()};l.addEventListener("load",s),l.addEventListener("error",m=>{console.error("Failed to load script:",t,m);const u=new Error(`[ScriptLoadingError] Failed to load script: ${t}`);a(u)}),d||document.head.append(l)},[]),{isLoading:r,error:i,isSuccess:n}}const nt=t=>t&&t.charts,H=(t,r)=>{const{controls:e,toolbarItems:i,getChartEditor:a}=t;return r&&r.charts&&r.visualization&&r.visualization.ChartWrapper&&r.visualization.Dashboard&&(!e||r.visualization.ChartWrapper)&&(!a||r.visualization.ChartEditor)&&(!i||r.visualization.drawToolbar)},st=t=>window.google;function it(t){const{chartVersion:r="current",chartPackages:e=["corechart","controls"],chartLanguage:i="en",mapsApiKey:a}=t,[n,c]=f.useState(null),[g,d]=f.useState(null),[l,s]=f.useState(null),{isLoading:m,error:u,isSuccess:h}=ot(t.chartLoaderScriptUrl||"https://www.gstatic.com/charts/loader.js");return f.useEffect(()=>{if(!h)return;const b=st();if(!nt(b)){const S=new Error("[ScriptInitializationError] Script loaded but Google not attached to window.");d(S);return}if(H(t,b)){c(b);return}b.charts.load(r,{packages:e,language:i,mapsApiKey:a}),b.charts.setOnLoadCallback(()=>{if(!H(t,b)){const S=new Error("[GoogleChartsInitializationError] Google Charts not ready after load callback.");console.error(S),s(S);return}c(b)})},[h]),{error:u||g||l,isLoading:m,google:n}}const K={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{},chartLoaderScriptUrl:"https://www.gstatic.com/charts/loader.js"},ct=t=>{const{isReady:r,chartControls:e,filter:i}=t;return!r||!e||!(e!=null&&e.length)?null:F.createElement(F.Fragment,null,e.filter(a=>{let{controlProp:n,control:c}=a;return i?i({control:c,controlProp:n}):!0}).map(a=>{let{control:n}=a;return F.createElement("div",{key:n.getContainerId(),id:n.getContainerId()})}))};let V=0;const J=()=>(V+=1,`reactgooglegraph-${V}`),N=class N{};E(N,"initializeControls",r=>{for(let e=0;e<r.length;e+=1){const{controlType:i,options:a,controlWrapperParams:n}=r[e].controlProp;n&&"state"in n&&r[e].control.setState(n.state),r[e].control.setOptions(a),r[e].control.setControlType(i)}}),E(N,"listenToControlEvents",(r,e)=>{const{google:i}=e;return r.flatMap(a=>{const{control:n,controlProp:c}=a,{controlEvents:g=[]}=c;return g.map(d=>{const{callback:l,eventName:s}=d;return i.visualization.events.addListener(n,s,function(){for(var m=arguments.length,u=new Array(m),h=0;h<m;h++)u[h]=arguments[h];l({chartWrapper:null,controlWrapper:n,props:e,google:i,eventArgs:u})})})})}),E(N,"createControlId",r=>{let e;return typeof r>"u"?e=`googlechart-control-${J()}`:e=r,e}),E(N,"createChartControls",r=>{const{controls:e,google:i}=r;return e?e.map((a,n)=>{const{controlID:c,controlType:g,options:d,controlWrapperParams:l}=a,s=N.createControlId(c);return{controlProp:a,control:new i.visualization.ControlWrapper({containerId:s,controlType:g,options:d,...l})}}):null}),E(N,"addControls",r=>{const{chartWrapper:e,chartDashboard:i}=r,a=N.createChartControls(r);return!a||!i||!e?null:(i.bind(a.map(n=>{let{control:c}=n;return c}),e),N.initializeControls(a),a)});let W=N;const lt=t=>{const[r,e]=f.useState(null);return[f.useMemo(()=>!r||!t?null:t.map((a,n)=>{const c=r[n];return c?{controlProp:a,control:c}:void 0}).flatMap(a=>a?[a]:[]),[r,t]),e]},dt=(t,r)=>{f.useEffect(()=>{const e=W.listenToControlEvents(t??[],r);return()=>{e.forEach(i=>{r.google.visualization.events.removeListener(i)})}},[t,r])},ut=t=>{const[r,e]=lt(t.controls);return dt(r??[],t),{addControls:a=>{const n=W.addControls(a);e((n==null?void 0:n.map(c=>c.control))??null)},renderControl:a=>{const{chartWrapper:n,chartDashboard:c}=t;return f.createElement(ct,{...t,isReady:!!(n&&c),chartControls:r,filter:a})}}},ht=t=>{const r=f.useRef(null);return{chartId:(()=>{const{graphID:a,graph_id:n}=t,c=a||n;let g;return c?g=c:g=r.current||J(),r.current=g,r.current})()}},mt=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],ft=async function(t,r){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((i,a)=>{const n=`${e.headers?`headers=${e.headers}`:"headers=0"}`,c=`${e.query?`&tq=${encodeURIComponent(e.query)}`:""}`,g=`${e.gid?`&gid=${e.gid}`:""}`,d=`${e.sheet?`&sheet=${e.sheet}`:""}`,l=`${e.access_token?`&access_token=${e.access_token}`:""}`,s=`${n}${g}${d}${c}${l}`,m=`${r}/gviz/tq?${s}`;new t.visualization.Query(m).send(h=>{h.isError()?a(`Error in query:  ${h.getMessage()} ${h.getDetailedMessage()}`):i(h.getDataTable())})})},gt="#CCCCCC",w=class w{};E(w,"grayOutHiddenColumnsLabel",(r,e)=>{const{googleChartWrapper:i,options:a}=r;if(!i){console.error("googleChartWrapper is not defined");return}const n=i.getDataTable();if(!n)return;const c=n.getNumberOfColumns();if(e.length>0===!1)return;const d=Array.from({length:c-1}).map((l,s)=>{const m=w.getColumnId(n,s+1);return e.includes(m)?gt:a&&a.colors?a.colors[s]:mt[s]});i.setOptions({...a,colors:d}),i.draw()}),E(w,"listenToLegendToggle",(r,e)=>{const[i,a]=e,{google:n,googleChartWrapper:c}=r;if(!c){console.error("googleChartWrapper is not defined");return}return n.visualization.events.addListener(c,"select",()=>{const d=c.getChart().getSelection(),l=c.getDataTable();if(d.length===0||d[0].row!==null||!l)return;const s=d[0].column,m=w.getColumnId(l,s);i!=null&&i.includes(m)?a(u=>[...u.filter(h=>h!==m)]):a(u=>[...u,m])})}),E(w,"draw",async r=>{const{data:e,diffdata:i,rows:a,columns:n,options:c,chartType:g,formatters:d,spreadSheetUrl:l,spreadSheetQueryParameters:s,googleChartDashboard:m,googleChartWrapper:u,google:h,hiddenColumns:b,legendToggle:S,legend_toggle:P}=r;if(!u){console.error("draw was called with googleChartWrapper = null");return}let p,C=null;if(i){const A=h.visualization.arrayToDataTable(i.old),y=h.visualization.arrayToDataTable(i.new);C=h.visualization[g].prototype.computeDiff(A,y)}e?e instanceof h.visualization.DataTable?p=e:Array.isArray(e)?p=h.visualization.arrayToDataTable(e):p=new h.visualization.DataTable(e):a&&n?p=h.visualization.arrayToDataTable([n,...a]):l?p=await ft(h,l,s):p=h.visualization.arrayToDataTable([]);const z=p.getNumberOfColumns(),L=Array(z).fill(0).map((A,y)=>{const $=w.getColumnId(p,y);return b.includes($)?{label:p.getColumnLabel(y),type:p.getColumnType(y),calc:()=>null}:y}),D=u.getChart();u.getChartType()==="Timeline"&&D&&D.clearChart(),u.setChartType(g),u.setOptions(c||{});const T=new h.visualization.DataView(p);T.setColumns(L),u.setDataTable(T),u.draw(),m&&m.draw(p),C&&(u.setDataTable(C),u.draw()),d&&(w.applyFormatters({dataTable:p,formatters:d,google:h}),u.setDataTable(p),u.draw()),(S===!0||P===!0)&&w.grayOutHiddenColumnsLabel(r,b)}),E(w,"getColumnId",(r,e)=>r.getColumnId(e)||r.getColumnLabel(e)),E(w,"applyFormatters",r=>{let{dataTable:e,formatters:i,google:a}=r;for(let n of i)switch(n.type){case"ArrowFormat":{new a.visualization.ArrowFormat(n.options).format(e,n.column);return}case"BarFormat":{new a.visualization.BarFormat(n.options).format(e,n.column);return}case"ColorFormat":{const c=new a.visualization.ColorFormat(n.options),{ranges:g}=n;if(g)for(let d of g)c.addRange(...d);c.format(e,n.column);return}case"DateFormat":{new a.visualization.DateFormat(n.options).format(e,n.column);return}case"NumberFormat":{new a.visualization.NumberFormat(n.options).format(e,n.column);return}case"PatternFormat":{new a.visualization.PatternFormat(n.options).format(e,n.column);return}default:{console.warn(`Unknown formatter type: ${n.type}`);return}}});let x=w;const pt=t=>{const{google:r,googleChartWrapper:e,googleChartDashboard:i}=t,[a,n]=f.useState([]);f.useEffect(()=>{e&&x.draw({...t,hiddenColumns:a,googleChartWrapper:e,googleChartDashboard:i,google:r})},[a,t.data,t.rows,t.columns,t.options,t.chartLoaderScriptUrl,t.chartType,t.formatters,t.spreadSheetUrl,t.spreadSheetQueryParameters,t.legendToggle,t.legend_toggle]);const c=()=>{const{googleChartWrapper:l}=t;l&&l.draw()},g=l=>{const s=[],{legendToggle:m,legend_toggle:u}=t;if(x.draw({...t,hiddenColumns:a,googleChartWrapper:l,googleChartDashboard:i,google:r}),window.addEventListener("resize",c),u||m){const h=x.listenToLegendToggle(t,[a,n]);h&&s.push(h)}return s},d=(l,s)=>{window.removeEventListener("resize",c),s.forEach(m=>{r.visualization.events.removeListener(m)}),l.getChartType()==="Timeline"&&l.getChart()&&l.getChart().clearChart()};f.useEffect(()=>{if(!e)return;const l=g(e);return()=>{d(e,l)}},[e,g,d])},vt=t=>{const{chartEvents:r,google:e,googleChartWrapper:i}=t;if(r){if(!i){console.warn("listenToEvents was called before chart wrapper ready.");return}return r.map(a=>{let{eventName:n,callback:c}=a;return e.visualization.events.addListener(i,n,function(){for(var g=arguments.length,d=new Array(g),l=0;l<g;l++)d[l]=arguments[l];c({chartWrapper:i,props:t,google:e,eventArgs:d})})})}},Ct=t=>{f.useEffect(()=>{if(!t.googleChartWrapper)return;const r=vt(t);return()=>{r==null||r.forEach(e=>{t.google.visualization.events.removeListener(e)})}},[t])},bt=t=>{const[r,e]=f.useState(null),[i,a]=f.useState(null),{addControls:n,renderControl:c}=ut({...t,chartDashboard:i,chartWrapper:r});Ct({...t,googleChartWrapper:r});const{chartId:g}=ht(t),d=f.useRef(null),l=f.useRef(null);f.useEffect(()=>{const{options:p,google:C,chartType:z,chartWrapperParams:L,toolbarItems:D,getChartEditor:T,getChartWrapper:A,onLoad:y}=t,$={chartType:z,options:p,containerId:g,...L},O=new C.visualization.ChartWrapper($);O.setOptions(p||{}),A==null||A(O,C);const R=new C.visualization.Dashboard(d.current);D&&C.visualization.drawToolbar(l.current,D);let j=null;T&&(j=new C.visualization.ChartEditor,T({chartEditor:j,chartWrapper:O,google:C})),n({...t,chartDashboard:R,chartWrapper:O}),e(O),a(R),y==null||y(C,{google:C,chartWrapper:O,chartEditor:j,chartDashboard:R})},[]),pt({...t,googleChartWrapper:r,googleChartDashboard:i});const s=()=>{const{width:p,height:C,options:z,style:L,className:D,rootProps:T,google:A}=t,y={height:C||z&&z.height,width:p||z&&z.width,...L};return f.createElement("div",{id:g,style:y,className:D,...T})},m=()=>t.toolbarItems?f.createElement("div",{ref:l}):null,{width:u,height:h,options:b,style:S}=t,P={height:h||b&&b.height,width:u||b&&b.width,...S};return t.render?f.createElement("div",{ref:d,style:P},f.createElement("div",{ref:l,id:"toolbar"}),t.render({renderChart:s,renderControl:c,renderToolbar:m})):f.createElement("div",{ref:d,style:P},c(p=>{let{controlProp:C}=p;return C.controlPosition!=="bottom"}),s(),c(p=>{let{controlProp:C}=p;return C.controlPosition==="bottom"}),m())},yt=f.createContext(K),wt=t=>{let{children:r,value:e}=t;return f.createElement(yt.Provider,{value:e},r)},St=t=>{const{google:r,isLoading:e,error:i}=it(t);return e?t.loader??null:i?t.errorElement??null:r?F.createElement(bt,{google:r,...t}):null},M=t=>{const r={...K,...t};return F.createElement(wt,{value:r},F.createElement(St,r))};var Q;(function(t){t.annotation="annotation",t.annotationText="annotationText",t.certainty="certainty",t.emphasis="emphasis",t.interval="interval",t.scope="scope",t.style="style",t.tooltip="tooltip",t.domain="domain"})(Q||(Q={}));const Et=()=>{const[t,r]=f.useState([]);f.useEffect(()=>{e()},[]);const e=async()=>{const d=B(k),l=q(d,"order"),s=await Y(l);if(s.exists()){const m=s.val(),u=Object.keys(m).map(h=>({...m[h],fireBaseID:h}));r(u)}else alert("No data available")},i=()=>t.length,a=d=>t.filter(l=>l.status===d).length,n=()=>{const d={};return t.forEach(l=>{var m;const s=((m=l.date)==null?void 0:m.split("T")[0])||"Unknown";d[s]||(d[s]=0),d[s]++}),Object.entries(d).map(([l,s])=>[l,s])},c=()=>{const d=[["Status","Number of Orders"],["Chưa xác nhận",a("chưa xác nhận")],["Đã xác nhận",a("đã xác nhận")],["Hoàn thành",a("đã hoàn thành")]];return o("div",{className:"chart-container",children:o(M,{chartType:"PieChart",data:d,options:{title:"Order Status Distribution",pieHole:.4,is3D:!1,colors:["#FF7043","#66BB6A","#42A5F5"],fontName:"Arial",fontSize:14,titleTextStyle:{fontSize:18,bold:!0,color:"#333"},legend:{position:"bottom",textStyle:{fontSize:14,color:"#333"}},tooltip:{textStyle:{fontSize:14,color:"#333"}},chartArea:{width:"90%",height:"75%"},pieSliceText:"value",slices:{0:{offset:.1},1:{offset:.1},2:{offset:.1}},backgroundColor:"#f4f4f4"},width:"100%",height:"400px"})})},g=()=>{const d=[["Date","Number of Orders"],...n()];return o("div",{className:"chart-container",children:o(M,{chartType:"LineChart",data:d,options:{title:"Orders Over Time",hAxis:{title:"Date",textStyle:{color:"#333"},titleTextStyle:{color:"#333"}},vAxis:{title:"Number of Orders",textStyle:{color:"#333"},titleTextStyle:{color:"#333"}},curveType:"function",colors:["#42A5F5"],fontName:"Arial",fontSize:14,titleTextStyle:{fontSize:18,bold:!0,color:"#333"},legend:{position:"bottom",textStyle:{fontSize:14,color:"#333"}},tooltip:{textStyle:{fontSize:14,color:"#333"}},chartArea:{width:"90%",height:"75%"},gridlines:{color:"#ccc"},backgroundColor:"#f4f4f4",pointSize:5,lineWidth:3},width:"100%",height:"400px"})})};return v("div",{className:"order-detail",children:[v("div",{className:"order-summary",children:[v("div",{className:"total-orders",children:["Total Orders: ",i()]}),v("div",{className:"orders-pending",children:["Orders chưa xác nhận: ",a("chưa xác nhận")]}),v("div",{className:"orders-confirmed",children:["Orders chưa hoàn thành: ",a("đã xác nhận")]})]}),v("div",{className:"order-charts",children:[o(c,{}),o(g,{})]})]})},Nt=()=>o(U,{}),Ot=()=>{const t=G(),[r,e]=f.useState(!1),i=et();return f.useEffect(()=>{const a=rt(i,n=>{n?e(!0):(e(!1),t("/login"))});return()=>a()},[i,t]),r?v(U,{children:[v("div",{className:"sidebar",children:[o("h2",{children:"Admin Dashboard"}),v("ul",{children:[o("li",{children:o("a",{href:"/my-first-reactjs-project/#/admin/dashboard",children:"Dashboard"})}),o("li",{children:o("a",{href:"/my-first-reactjs-project/#/admin/users",children:"Users"})}),o("li",{children:o("a",{href:"/my-first-reactjs-project/#/admin/products",children:"Products"})}),o("li",{children:o("a",{href:"/my-first-reactjs-project/#/admin/orders",children:"Orders"})})]})]}),v(_,{children:[o(I,{path:"/dashboard",element:o(Et,{})}),o(I,{path:"/users",element:o("h1",{children:"Users"})}),o(I,{path:"/products",element:o(Nt,{})}),o(I,{path:"/orders",element:o(at,{})})]})]}):o("p",{children:"Redirecting to login..."})};export{Ot as default};
